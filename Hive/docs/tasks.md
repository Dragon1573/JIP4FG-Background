# Hive 数据分析需求

## 计数、排序、条件过滤与窗口函数

- 企业信息表 `tb_company_info`

  1. （ `rs_ci_1` ）全表共有多少家企业？

        |   列名称    | 数据类型 |   备注   |
        | :---------: | :------: | :------: |
        | total_count |  BIGINT  | 企业总数 |

  2. （ `rs_ci_2` ）拥有2家及以上分公司的企业有哪些？按分公司数量降序排列。

        |    列名称    | 数据类型 |    备注    |
        | :----------: | :------: | :--------: |
        | company_name |  STRING  |  企业名称  |
        |    counts    |  BIGINT  | 分公司数量 |

  3. （ `tb_industry_rank` ）这些企业都在哪些行业？列出前10个热门行业。

        |    列名称     | 数据类型 |     备注     |
        | :-----------: | :------: | :----------: |
        |  industry_id  |  STRING  |  行业 UUID   |
        | industry_type |  STRING  | 企业所属行业 |
        |     count     |  BIGINT  |   企业数量   |

  4. （ `tb_city_company_count` ）这些企业主要集中在哪些城市？按企业数量降序排序。

        |  列名称   | 数据类型 |        备注        |
        | :-------: | :------: | :----------------: |
        |   city    |  STRING  | 城市（或省份）名称 |
        | com_count |  BIGINT  |      企业数量      |

- 表 `tb_job_info`
  1. （ `rs_ji_1` ）全表共有多少个实习职位？

        | 列名称 | 数据类型 |   备注   |
        | :----: | :------: | :------: |
        | counts |  BIGINT  | 职位总数 |

  2. （ `rs_ji_2` ）发布了2个及以上实习职位的企业有哪些？按职位数量降序排列。

        |    列名称    | 数据类型 |   备注    |
        | :----------: | :------: | :-------: |
        |  company_id  |  STRING  | 企业 UUID |
        | company_name |  STRING  | 企业名称  |
        |    counts    |  BIGINT  | 职位数量  |
  
  3. （ `rs_ji_3` ）筛选前10个最热门的职位名称，并展示其职位数量。
  
        |  列名称  | 数据类型 |   备注   |
        | :------: | :------: | :------: |
        | job_name |  STRING  | 职位名称 |
        |  counts  |  BIGINT  | 职位数量 |
        |  ranks   |   INT    | 稠密排序 |
  
  4. （ `rs_ji_4` ）在众多职位中，职位工作地点与企业所在位置相同（市属于省也视为不同）的职位有多少个？
  
        | 列名称 | 数据类型 |   备注   |
        | :----: | :------: | :------: |
        | counts |  BIGINT  | 职位数量 |
  
  5. （ `rs_ji_5` ）在众多实习职位中，职位数量前3的城市是？它们分别提供了多少职位（数量及比例）？
  
        |   列名称   | 数据类型 |        备注        |
        | :--------: | :------: | :----------------: |
        |  location  |  STRING  |      城市名称      |
        |   counts   |  BIGINT  |      职位数量      |
        | percentage |  DOUBLE  | 所占比例（千分位） |
        |   ranks    |   INT    |      稠密排序      |

- 表 `tb_job_salary`
  1. （ `rs_js_1` ）在众多职位中，企业给出的一般薪资在什么水平？获取职位数量最多的前5个薪资水平。

        | 列名称 | 数据类型 |       备注        |
        | :----: | :------: | :---------------: |
        | salary |  STRING  | 实习薪资（元/月） |
        | counts |  BIGINT  |     职位数量      |
        | ranks  |   INT    |     稠密排序      |

  2. （ `rs_js_2` ）在众多职位中，企业主要在什么时候发布实习信息？统计每月发布的职位数量并计算其比例。

        |   列名称   | 数据类型 |        备注        |
        | :--------: | :------: | :----------------: |
        |  month_id  |  STRING  |        月份        |
        |   counts   |  BIGINT  |      职位数量      |
        | percentage |  DOUBLE  | 所占比例（千分位） |
        |   ranks    |   INT    |      稠密排序      |
